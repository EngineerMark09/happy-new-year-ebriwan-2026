"use strict";!function(){var t="Begin when ready.",e="Happy New Year",i="A moment begins.",n=2e3,s=100,o=600,r=300,a=300,c=8e3,l=1500,u=5e3,h=2e3,d="assets/ambient.mp3",m="assets/tick.mp3",f="assets/firework.mp3",v=.4,g=.15,p=.3,w={phase:"arrival",countdownValue:10,isMuted:!1,audioInitialized:!1},y={context:null,ambient:null,tick:null,firework:null,ambientGain:null,init:function(){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(w.audioInitialized)return t.abrupt("return");t.next=2;break;case 2:try{this.context=new(window.AudioContext||window.webkitAudioContext),this.ambientGain=this.context.createGain(),this.ambientGain.connect(this.context.destination),this.ambientGain.gain.value=0,this.ambient=new Audio(d),this.ambient.loop=!0,this.ambient.volume=v,this.tick=new Audio(m),this.tick.volume=g,this.firework=new Audio(f),this.firework.volume=p,w.audioInitialized=!0}catch(t){console.warn("Audio initialization failed:",t)}case 3:case"end":return t.stop()}},null,this)},playAmbient:function(){return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.ambient||w.isMuted)return t.abrupt("return");t.next=2;break;case 2:return t.prev=2,this.ambient.volume=0,t.next=6,regeneratorRuntime.awrap(this.ambient.play());case 6:this.fadeIn(this.ambient,v,h),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.warn("Ambient playback failed:",t.t0);case 12:case"end":return t.stop()}},null,this,[[2,9]])},playTick:function(){if(this.tick&&!w.isMuted)try{this.tick.currentTime=0,this.tick.play().catch(function(){})}catch(t){}},playFirework:function(){if(this.firework&&!w.isMuted)try{this.firework.currentTime=0,this.firework.play().catch(function(){})}catch(t){}},fadeIn:function(a,s,o){var r=this,c=a.volume,l=performance.now();requestAnimationFrame(function t(e){var i=e-l,n=Math.min(i/o,1);a.volume=c+(s-c)*r.easeOut(n),n<1&&requestAnimationFrame(t)})},fadeOut:function(a,s){var o=this,r=a.volume,c=performance.now();requestAnimationFrame(function t(e){var i=e-c,n=Math.min(i/s,1);a.volume=r*(1-o.easeOut(n)),n<1&&requestAnimationFrame(t)})},easeOut:function(t){return 1-Math.pow(1-t,3)},toggleMute:function(){return w.isMuted=!w.isMuted,this.ambient&&(this.ambient.muted=w.isMuted),this.tick&&(this.tick.muted=w.isMuted),this.firework&&(this.firework.muted=w.isMuted),w.isMuted},stopAll:function(){this.ambient&&this.fadeOut(this.ambient,1e3)}},x={canvas:null,ctx:null,stars:[],animationId:null,init:function(){var t=this;this.canvas=document.getElementById("stars"),this.ctx=this.canvas.getContext("2d"),this.resize(),this.createStars(),this.animate(),window.addEventListener("resize",function(){return t.resize()})},resize:function(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight},createStars:function(){var t=Math.floor(window.innerWidth*window.innerHeight/8e3);this.stars=[];for(var e=0;e<t;e++)this.stars.push({x:Math.random()*this.canvas.width,y:Math.random()*this.canvas.height,size:1.5*Math.random()+.5,opacity:.5*Math.random()+.1,pulse:Math.random()*Math.PI*2,pulseSpeed:.01*Math.random()+.005})},animate:function(){var i=this;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.stars.forEach(function(t){t.pulse+=t.pulseSpeed;var e=t.opacity*(.5+.5*Math.sin(t.pulse));i.ctx.beginPath(),i.ctx.arc(t.x,t.y,t.size,0,2*Math.PI),i.ctx.fillStyle="rgba(255, 255, 255, ".concat(e,")"),i.ctx.fill()}),this.animationId=requestAnimationFrame(function(){return i.animate()})}},b={canvas:null,ctx:null,particles:[],rockets:[],animationId:null,isActive:!1,init:function(){var t=this;this.canvas=document.getElementById("fireworks"),this.ctx=this.canvas.getContext("2d"),this.resize(),window.addEventListener("resize",function(){return t.resize()})},resize:function(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight},start:function(){this.isActive=!0,this.canvas.classList.add("active"),this.launchSequence(),this.animate()},launchSequence:function(){var e=this;[{delay:0,x:.5},{delay:800,x:.3},{delay:1200,x:.7},{delay:2e3,x:.4},{delay:2500,x:.6},{delay:3200,x:.2},{delay:3800,x:.8},{delay:4500,x:.5},{delay:5200,x:.35},{delay:5800,x:.65},{delay:6500,x:.45},{delay:7200,x:.55}].forEach(function(t){setTimeout(function(){e.isActive&&e.createRocket(t.x)},t.delay)})},createRocket:function(t){var e=this.canvas.width*t,i=this.canvas.height*(.2+.3*Math.random());this.rockets.push({x:e,y:this.canvas.height,targetY:i,speed:8+4*Math.random(),trail:[]})},explode:function(t,e){y.playFirework();for(var i=["rgba(255, 230, 200, ","rgba(255, 200, 150, ","rgba(255, 180, 140, ","rgba(200, 180, 255, ","rgba(180, 200, 255, "],n=i[Math.floor(Math.random()*i.length)],a=80+Math.floor(40*Math.random()),s=0;s<a;s++){var o=2*Math.PI*s/a+.2*Math.random(),r=2+4*Math.random();this.particles.push({x:t,y:e,vx:Math.cos(o)*r,vy:Math.sin(o)*r,life:1,decay:.008+.008*Math.random(),color:n,size:2+2*Math.random(),trail:[]})}},animate:function(){var a=this;this.ctx.fillStyle="rgba(0, 0, 0, 0.08)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.rockets=this.rockets.filter(function(n){return n.y-=n.speed,n.trail.push({x:n.x,y:n.y}),10<n.trail.length&&n.trail.shift(),n.trail.forEach(function(t,e){var i=e/n.trail.length*.5;a.ctx.beginPath(),a.ctx.arc(t.x,t.y,1,0,2*Math.PI),a.ctx.fillStyle="rgba(255, 200, 150, ".concat(i,")"),a.ctx.fill()}),!(n.y<=n.targetY)||(a.explode(n.x,n.y),!1)}),this.particles=this.particles.filter(function(n){return n.x+=n.vx,n.y+=n.vy,n.vy+=.05,n.vx*=.99,n.life-=n.decay,n.trail.push({x:n.x,y:n.y,life:n.life}),5<n.trail.length&&n.trail.shift(),n.trail.forEach(function(t,e){var i=.3*t.life*(e/n.trail.length);a.ctx.beginPath(),a.ctx.arc(t.x,t.y,.5*n.size,0,2*Math.PI),a.ctx.fillStyle=n.color+i+")",a.ctx.fill()}),0<n.life&&(a.ctx.beginPath(),a.ctx.arc(n.x,n.y,n.size*n.life,0,2*Math.PI),a.ctx.fillStyle=n.color+n.life+")",a.ctx.fill()),0<n.life}),this.animationId=requestAnimationFrame(function(){return a.animate()})},fadeOut:function(){var t=this;this.isActive=!1,setTimeout(function(){t.canvas.classList.remove("active")},3e3)}},M={elements:{},init:function(){this.elements={body:document.body,phaseArrival:document.getElementById("phase-arrival"),phaseCountdown:document.getElementById("phase-countdown"),phaseMessage:document.getElementById("phase-message"),beginButton:document.getElementById("beginButton"),countdownNumber:document.getElementById("countdownNumber"),controls:document.getElementById("controls"),replayButton:document.getElementById("replayButton"),soundToggle:document.getElementById("soundToggle"),messageMain:document.querySelector(".message-main"),messageSub:document.querySelector(".message-sub")},document.querySelector(".arrival-text").textContent=t,this.elements.messageMain.textContent=e,this.elements.messageSub.textContent=i,x.init(),b.init(),this.bindEvents()},bindEvents:function(){var e=this;this.elements.beginButton.addEventListener("click",function(){return e.begin()}),this.elements.replayButton.addEventListener("click",function(){return e.replay()}),this.elements.soundToggle.addEventListener("click",function(){return e.toggleSound()}),document.addEventListener("keydown",function(t){"Enter"===t.key&&"arrival"===w.phase&&e.begin(),"m"===t.key&&"afterglow"===w.phase&&e.toggleSound()})},begin:function(){var e=this;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return w.phase="initiation",t.next=3,regeneratorRuntime.awrap(y.init());case 3:this.elements.body.classList.add("immersive"),y.playAmbient(),this.elements.phaseArrival.classList.remove("active"),setTimeout(function(){e.startCountdown()},n);case 7:case"end":return t.stop()}},null,this)},startCountdown:function(){w.phase="countdown",w.countdownValue=10,this.elements.phaseCountdown.classList.add("active"),this.showNumber()},showNumber:function(){for(var t=this,e=w.countdownValue,i=this.elements.countdownNumber,n=this.elements.phaseCountdown,a=1;a<=10;a++)n.classList.remove("pressure-".concat(a));n.classList.add("pressure-".concat(11-e)),i.textContent=e,i.classList.remove("dissolve"),i.classList.add("visible"),y.playTick(),setTimeout(function(){i.classList.add("dissolve"),i.classList.remove("visible"),setTimeout(function(){w.countdownValue--,0<w.countdownValue?t.showNumber():t.zeroMoment()},r)},s+o)},zeroMoment:function(){var t=this;w.phase="zero",this.elements.phaseCountdown.classList.remove("active"),setTimeout(function(){t.release()},a)},release:function(){var t=this;w.phase="release",b.start(),setTimeout(function(){t.showMessage()},l),setTimeout(function(){t.afterglow()},c)},showMessage:function(){w.phase="message",this.elements.phaseMessage.classList.add("active")},afterglow:function(){var t=this;w.phase="afterglow",b.fadeOut(),this.elements.body.classList.remove("immersive"),setTimeout(function(){t.elements.controls.classList.add("visible")},u-c)},replay:function(){w.phase="arrival",w.countdownValue=10,this.elements.body.classList.remove("immersive"),this.elements.phaseArrival.classList.add("active"),this.elements.phaseCountdown.classList.remove("active"),this.elements.phaseMessage.classList.remove("active"),this.elements.controls.classList.remove("visible");for(var t=1;t<=10;t++)this.elements.phaseCountdown.classList.remove("pressure-".concat(t));b.isActive=!1,b.particles=[],b.rockets=[],b.ctx.clearRect(0,0,b.canvas.width,b.canvas.height),b.canvas.classList.remove("active"),y.ambient&&(y.ambient.currentTime=0,y.ambient.pause())},toggleSound:function(){var t=y.toggleMute();this.elements.soundToggle.classList.toggle("muted",t)}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){return M.init()}):M.init()}();
//# sourceMappingURL=script.min.js.map
